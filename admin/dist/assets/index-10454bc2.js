import{e as m,p as f,o as y,f as g,w as s,j as l,i as p,k as w,s as t,y as h,v as _,m as u,N as k}from"./index-25b6f427.js";import{_ as v}from"./CommonPage-d9f08a53.js";import{_ as b,a as N}from"./CrudTable-4e3fed7c.js";import{N as x}from"./Image-3d736508.js";import{N as $}from"./Input-4dc6aa48.js";import{N as I}from"./Popconfirm-48a94d36.js";import"./AppPage-77502b8b.js";import"./Space-5eeaf57e.js";import"./RadioGroup-9f11dd0d.js";import"./get-slot-1efb97e5.js";import"./Checkbox-09b0afd8.js";import"./Forward-98208075.js";import"./download-953ccaa2.js";import"./utils-a56d3b30.js";const V=Object.assign({name:"在线用户"},{__name:"index",setup(q){const i=m(null),n=m({keyword:""});f(()=>{var e;(e=i.value)==null||e.handleSearch()});const d=[{title:"头像",key:"avatar",width:30,align:"center",render(e){return t(x,{height:30,src:h(e.info.avatar),"fallback-src":"http://dummyimage.com/400x400","show-toolbar-tooltip":!0})}},{title:"昵称",key:"nickname",width:60,align:"center",ellipsis:{tooltip:!0},render(e){return t("span",e.info.nickname||"未知")}},{title:"登录 IP",key:"ip_address",width:70,align:"center",ellipsis:{tooltip:!0},render(e){return t("span",e.ip_address||"未知")}},{title:"登录地址",key:"ip_source",width:70,align:"center",ellipsis:{tooltip:!0},render(e){return t("span",e.ip_source||"未知")}},{title:"登录浏览器",key:"browser",width:70,align:"center",ellipsis:{tooltip:!0},render(e){return t("span",e.browser||"未知")}},{title:"操作系统",key:"os",width:70,align:"center",ellipsis:{tooltip:!0},render(e){return t("span",e.os||"未知")}},{title:"登录时间",key:"last_login_time",align:"center",width:70,render(e){return t("span",_(e.last_login_time,"YYYY-MM-DD HH:mm:ss"))}},{title:"操作",key:"actions",width:60,align:"center",fixed:"right",render(e){return t(I,{onPositiveClick:()=>c(e)},{trigger:()=>t(k,{size:"small",type:"warning"},{default:()=>"下线",icon:()=>t("i",{class:"i-material-symbols:delete-outline"})}),default:()=>t("div",{},"确定强制该用户下线吗?")})}}];async function c(e){var r;try{await u.forceOfflineUser(e.id),window.$message.success("该用户已被强制下线!"),(r=i.value)==null||r.handleSearch()}catch(a){console.error(a)}}return(e,r)=>(y(),g(v,{title:"在线用户"},{default:s(()=>[l(N,{ref_key:"$table",ref:i,"query-items":n.value,"onUpdate:queryItems":r[2]||(r[2]=a=>n.value=a),columns:d,"get-data":p(u).getOnlineUsers,"is-pagination":!1},{queryBar:s(()=>[l(b,{label:"用户名 | 昵称","label-width":100,"content-width":200},{default:s(()=>[l(p($),{value:n.value.keyword,"onUpdate:value":r[0]||(r[0]=a=>n.value.keyword=a),clearable:"",type:"text",placeholder:"搜索关键字",onKeydown:r[1]||(r[1]=w(a=>{var o;return(o=i.value)==null?void 0:o.handleSearch()},["enter"]))},null,8,["value"])]),_:1})]),_:1},8,["query-items","get-data"])]),_:1}))}});export{V as default};
