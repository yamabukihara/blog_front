import{_ as R}from"./CrudModal-b3ba9d09.js";import{_ as q}from"./UploadOne-7705b998.js";import{_ as B}from"./CommonPage-d9f08a53.js";import{e as p,p as O,m as n,o as f,f as V,w as r,j as a,g as s,l as P,i as l,V as w,a7 as $,a6 as j,aO as L,q as T,N as z,b1 as E,y as A,t as M,s as x}from"./index-25b6f427.js";import{u as G}from"./useCRUD-98c77b73.js";import{N as H}from"./Image-3d736508.js";import{N as J,a as u}from"./FormItem-d42d036b.js";import{N as v}from"./Input-4dc6aa48.js";import"./Upload-af1387d7.js";import"./download-953ccaa2.js";import"./Add-d4ec7561.js";import"./AppPage-77502b8b.js";import"./utils-a56d3b30.js";const K={class:"flex flex-wrap justify-between"},Q={class:"absolute right-2 top-1 text-white"},W={class:"text-base"},X={class:"w-full flex items-center justify-between"},pe={__name:"index",setup(Y){const{modalVisible:d,modalTitle:y,modalLoading:h,handleAdd:N,handleDelete:k,handleEdit:U,handleSave:_,modalForm:i,modalFormRef:F}=G({name:"页面",initForm:{},doCreate:n.saveOrUpdatePage,doDelete:n.deletePage,doUpdate:n.saveOrUpdatePage,refresh:c}),g=p([]),m=p(!1),b=p(null);O(async()=>{c()});async function c(){const o=await n.getPages();g.value=o.data}function C(o){m.value=!0,b.value.previewImg=o,setTimeout(()=>m.value=!1,600)}function S(o,e){o==="edit"?U(e):o==="delete"&&k([e.id])}const D=[{label:"编辑",key:"edit",icon:()=>x("i",{class:"i-mingcute:edit-2-line"})},{label:"删除",key:"delete",icon:()=>x("i",{class:"i-mingcute:delete-back-line"})}];return(o,e)=>(f(),V(B,{title:"页面管理"},{action:r(()=>[a(l(z),{type:"primary",onClick:l(N)},{icon:r(()=>e[7]||(e[7]=[s("i",{class:"i-material-symbols:add"},null,-1)])),default:r(()=>[e[8]||(e[8]=P(" 新建页面 "))]),_:1},8,["onClick"])]),default:r(()=>[s("div",K,[(f(!0),w(j,null,$(g.value,t=>(f(),w("div",{key:t.id,class:"relative my-2 w-[300px] cursor-pointer text-center"},[s("div",Q,[a(l(E),{options:D,onSelect:I=>S(I,t)},{default:r(()=>e[9]||(e[9]=[s("span",{class:"i-ion:ellipsis-horizontal h-5 w-5 text-white hover:text-blue"},null,-1)])),_:2},1032,["onSelect"])]),a(l(H),{src:l(A)(t.cover),height:"170",width:"300","img-props":{style:{"border-radius":"5px"}}},null,8,["src"]),s("p",W,M(t.name),1)]))),128)),e[10]||(e[10]=s("div",{class:"h-0 w-[300px]"},null,-1)),e[11]||(e[11]=s("div",{class:"h-0 w-[300px]"},null,-1)),e[12]||(e[12]=s("div",{class:"h-0 w-[300px]"},null,-1))]),a(R,{visible:l(d),"onUpdate:visible":e[6]||(e[6]=t=>T(d)?d.value=t:null),width:"550px",title:l(y),loading:l(h),onSave:l(_)},{default:r(()=>[a(l(J),{ref_key:"modalFormRef",ref:F,"label-placement":"left","label-align":"left","label-width":80,model:l(i)},{default:r(()=>[a(l(u),{label:"页面名称",path:"name",rule:{required:!0,message:"请输入页面名称",trigger:["input","blur"]}},{default:r(()=>[a(l(v),{value:l(i).name,"onUpdate:value":e[0]||(e[0]=t=>l(i).name=t),placeholder:"页面名称"},null,8,["value"])]),_:1}),a(l(u),{label:"页面标签",path:"label",rule:{required:!0,message:"请输入页面标签",trigger:["input","blur"]}},{default:r(()=>[a(l(v),{value:l(i).label,"onUpdate:value":e[1]||(e[1]=t=>l(i).label=t),placeholder:"页面标签"},null,8,["value"])]),_:1}),a(l(u),{label:"页面封面",path:"cover",rule:{required:!0,message:"请上传封面图片",trigger:["input","blur"]}},{default:r(()=>[s("div",X,[a(q,{ref_key:"uploadOneRef",ref:b,preview:l(i).cover,"onUpdate:preview":e[2]||(e[2]=t=>l(i).cover=t),width:300,onFinish:e[3]||(e[3]=t=>l(i).cover=t)},null,8,["preview"]),s("span",{class:L(["i-uiw:reload h-5 w-5 cursor-pointer",m.value?"animate-spin":""]),onClick:e[4]||(e[4]=t=>C(l(i).cover))},null,2)])]),_:1}),a(l(u),{label:"封面链接",path:"cover",rule:{required:!0,message:"请输入封面链接",trigger:["input","blur"]}},{default:r(()=>[a(l(v),{value:l(i).cover,"onUpdate:value":e[5]||(e[5]=t=>l(i).cover=t),type:"textarea",placeholder:"图片上传成功自动生成，或者直接复制外链"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title","loading","onSave"])]),_:1}))}};export{pe as default};
