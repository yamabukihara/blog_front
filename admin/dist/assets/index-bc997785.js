import{p as $,e as f,o as T,f as U,w as r,m as y,j as n,g as h,l as v,i as s,k as S,s as l,y as q,z as p,N as m,v as z}from"./index-25b6f427.js";import{_ as B}from"./CommonPage-d9f08a53.js";import{_ as x,a as I}from"./CrudTable-4e3fed7c.js";import{c as N,d as P}from"./config-7d76553c.js";import{u as D}from"./useCRUD-98c77b73.js";import{N as R}from"./Image-3d736508.js";import{N as V,a as g}from"./Tabs-1dd6aa6f.js";import{N as j}from"./Input-4dc6aa48.js";import{N as K}from"./Space-5eeaf57e.js";import{N as M}from"./Popconfirm-48a94d36.js";import"./AppPage-77502b8b.js";import"./Checkbox-09b0afd8.js";import"./RadioGroup-9f11dd0d.js";import"./get-slot-1efb97e5.js";import"./Forward-98208075.js";import"./download-953ccaa2.js";import"./utils-a56d3b30.js";import"./Add-d4ec7561.js";const ne=Object.assign({name:"评论管理"},{__name:"index",setup(O){$(()=>{k("all")});const o=f(null),u=f({nickname:"",type:""}),d=f({is_review:null}),{handleDelete:w}=D({name:"评论",doDelete:y.deleteComments,refresh:()=>{var t;return(t=o.value)==null?void 0:t.handleSearch()}}),_=[{type:"selection",width:15,fixed:"left"},{title:"头像",key:"avatar",width:40,align:"center",render(t){var e,a;return l(R,{height:40,imgProps:{style:{"border-radius":"3px"}},src:q((a=(e=t.user)==null?void 0:e.info)==null?void 0:a.avatar),"fallback-src":"http://dummyimage.com/400x400","show-toolbar-tooltip":!0})}},{title:"评论人",key:"nickname",width:50,align:"center",ellipsis:{tooltip:!0},render(t){var e,a;return l("span",((a=(e=t.user)==null?void 0:e.info)==null?void 0:a.nickname)||"无")}},{title:"评论类型",key:"",width:50,align:"center",render(t){if(t.type===1)return[l(p,{type:"info"},{default:()=>"文章"})];if(t.type===2)return l(p,{type:"success"},{default:()=>"友链"})}},{title:"回复对象",key:"reply_nick_name",width:50,align:"center",render(t){var e,a;return l("span",((a=(e=t.reply_user)==null?void 0:e.info)==null?void 0:a.nickname)||"-")}},{title:"评论内容",key:"content",width:140,align:"center",ellipsis:{tooltip:!0}},{title:"评论时间",key:"created_at",align:"center",width:60,render(t){return l(m,{size:"small",type:"text",ghost:!0},{default:()=>z(t.created_at),icon:()=>l("i",{class:"i-mdi:update"})})}},{title:"状态",key:"is_review",width:50,align:"center",render(t){return l(p,{type:t.is_review?"success":"error"},{default:()=>t.is_review?"通过":"审核中"})}},{title:"来源",key:"type",width:50,align:"center",render(t){return l(p,{type:N[t.type].tag},{default:()=>N[t.type].name})}},{title:"操作",key:"actions",width:100,align:"center",fixed:"right",render(t){return[t.is_review?l(m,{size:"small",type:"warning",style:"margin-left: 15px;",onClick:()=>c([t.id],!1)},{default:()=>"撤下",icon:()=>l("i",{class:"i-mi:circle-error"})}):l(m,{size:"small",type:"success",style:"margin-left: 15px;",onClick:()=>c([t.id],!0)},{default:()=>"通过",icon:()=>l("i",{class:"i-mi:circle-check"})}),l(M,{onPositiveClick:()=>w([t.id],!1)},{trigger:()=>l(m,{size:"small",type:"error",style:"margin-left: 15px;"},{default:()=>"删除",icon:()=>l("i",{class:"i-material-symbols:delete-outline"})}),default:()=>l("div",{},"确定删除该条评论吗?")})]}}];async function c(t,e){var a,i;if(!t.length){window.$message.info("请选择要审核的数据");return}await y.updateCommentReview(t,e),(a=window.$message)==null||a.success(e?"审核成功":"撤下成功"),(i=o.value)==null||i.handleSearch()}function k(t){var e;switch(t){case"all":d.value.is_review=null;break;case"has_review":d.value.is_review=!0;break;case"not_review":d.value.is_review=!1;break}(e=o.value)==null||e.handleSearch()}return(t,e)=>(T(),U(B,{title:"评论管理"},{action:r(()=>{var a,i;return[n(s(m),{type:"error",disabled:!((a=o.value)!=null&&a.selections.length),onClick:e[0]||(e[0]=C=>{var b;return s(w)((b=o.value)==null?void 0:b.selections)})},{icon:r(()=>e[7]||(e[7]=[h("span",{class:"i-material-symbols:recycling-rounded"},null,-1)])),default:r(()=>[e[8]||(e[8]=v(" 批量删除 "))]),_:1},8,["disabled"]),n(s(m),{type:"success",disabled:!((i=o.value)!=null&&i.selections.length),onClick:e[1]||(e[1]=C=>c(o.value.selections,!0))},{icon:r(()=>e[9]||(e[9]=[h("span",{class:"i-ic:outline-approval"},null,-1)])),default:r(()=>[e[10]||(e[10]=v(" 批量通过 "))]),_:1},8,["disabled"])]}),default:r(()=>[n(s(V),{type:"line",animated:"","onUpdate:value":k},{prefix:r(()=>e[11]||(e[11]=[v(" 状态 ")])),default:r(()=>[n(s(g),{name:"all",tab:"全部"}),n(s(g),{name:"has_review",tab:"通过"}),n(s(g),{name:"not_review",tab:"审核中"})]),_:1}),n(I,{ref_key:"$table",ref:o,"query-items":u.value,"onUpdate:queryItems":e[6]||(e[6]=a=>u.value=a),"extra-params":d.value,columns:_,"get-data":s(y).getComments},{queryBar:r(()=>[n(x,{label:"用户","label-width":40,"content-width":180},{default:r(()=>[n(s(j),{value:u.value.nickname,"onUpdate:value":e[2]||(e[2]=a=>u.value.nickname=a),clearable:"",type:"text",placeholder:"请输入用户昵称",onKeydown:e[3]||(e[3]=S(a=>{var i;return(i=o.value)==null?void 0:i.handleSearch()},["enter"]))},null,8,["value"])]),_:1}),n(x,{label:"来源","label-width":40,"content-width":160},{default:r(()=>[n(s(K),{value:u.value.type,"onUpdate:value":[e[4]||(e[4]=a=>u.value.type=a),e[5]||(e[5]=a=>{var i;return(i=o.value)==null?void 0:i.handleSearch()})],clearable:"",filterablec:"",placeholder:"请选择评论来源",options:s(P)},null,8,["value","options"])]),_:1})]),_:1},8,["query-items","extra-params","get-data"])]),_:1}))}});export{ne as default};
