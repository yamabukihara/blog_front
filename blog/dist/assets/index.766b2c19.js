import{r as b,l as _,s as h,b as i,c as d,f as e,I as w,E as x,o as y,A as k,q as $,P as U,h as I,z as S,i as B,e as z,M as C,F as D,H as F}from"./index.08377aad.js";import{_ as V}from"./BannerPage.da11c744.js";import"./AppFooter.1997c78d.js";import"./ULoading.6ad0004d.js";const M={class:"flex items-center justify-center bg-gray-100 font-sans"},N={for:"dropzone-file",class:"mx-auto max-w-[300px] w-full cursor-pointer items-center border-1 border-blue-400 rounded-xl border-dashed bg-white p-2 text-center"},O={key:0,class:"group relative"},R=["src"],j={key:1,class:"f-c-c lg:h-[160px] lg:w-[160px]"},q={__name:"UploadOne",props:{preview:{type:String,default:""}},emits:["update:preview"],setup(f,{emit:t}){const p=f,o=t,n=b(p.preview),l=_(()=>h(n.value)),s=b(null);async function a(){var g,v;const c=s.value.files[0],r=new FormData;r.append("file",c);try{const{token:u}=w(),m=await(await fetch("/api/front/upload",{method:"POST",headers:{Authorization:`Bearer ${u}`},body:r})).json();if(m.code!==0){(g=window.$message)==null||g.error(m.message);return}n.value=m.data,o("update:preview",n)}catch(u){console.error(u),(v=window.$message)==null||v.error("\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25")}}return(c,r)=>(i(),d("main",M,[e("label",N,[n.value?(i(),d("div",O,[e("img",{class:"lg:h-[160px] lg:w-[160px]",src:l.value,alt:"user avatar"},null,8,R),r[0]||(r[0]=e("div",{class:"absolute bottom-0 left-0 right-0 top-0 f-c-c cursor-pointer"},[e("button",{class:"i-mdi:upload pointer-events-none inline-block text-[50px] text-white opacity-35 duration-200 group-hover:opacity-80"})],-1))])):(i(),d("div",j,r[1]||(r[1]=[e("div",{class:"flex flex-col items-center"},[e("span",{class:"i-mdi:upload text-[58px] text-blue-500"}),e("span",{class:"text-blue-400"}," \u70B9\u51FB\u4E0A\u4F20\u6587\u4EF6")],-1)]))),e("input",{id:"dropzone-file",ref_key:"fileRef",ref:s,type:"file",class:"hidden",onChange:a},null,544)])]))}},A={class:"grid grid-cols-12 gap-4"},E={class:"col-span-4 f-c-c"},P={class:"col-span-8 lg:col-span-7"},T={class:"my-6 space-y-3"},H={class:"mb-2"},J=["onUpdate:modelValue","placeholder"],X={__name:"index",setup(f){const t=w(),p=U(),o=x({avatar:t.avatar,nickname:t.nickname,intro:t.intro,website:t.website,email:t.email});y(async()=>{await t.getUserInfo(),t.userId||p.push("/")});async function n(){var l;try{await F.updateUser(o),(l=window.$message)==null||l.success("\u4FEE\u6539\u6210\u529F!"),t.getUserInfo()}catch(s){console.error(s)}}return(l,s)=>(i(),k(V,{label:"user",title:"\u4E2A\u4EBA\u4E2D\u5FC3",card:""},{default:$(()=>[s[2]||(s[2]=e("p",{class:"mb-6 text-xl font-bold"}," \u57FA\u672C\u4FE1\u606F ",-1)),e("div",A,[e("div",E,[I(q,{preview:o.avatar,"onUpdate:preview":s[0]||(s[0]=a=>o.avatar=a)},null,8,["preview"])]),e("div",P,[e("div",T,[(i(),d(D,null,S([{label:"\u6635\u79F0",key:"nickname"},{label:"\u4E2A\u4EBA\u7F51\u7AD9",key:"website"},{label:"\u7B80\u4ECB",key:"intro"},{label:"\u90AE\u7BB1",key:"email"}],a=>e("div",{key:a.label},[e("div",H,B(a.label),1),z(e("input",{"onUpdate:modelValue":c=>o[a.key]=c,required:"",placeholder:`\u8BF7\u8F93\u5165${a.label}`,class:"block w-full border-0 rounded-md p-2 text-gray-900 shadow-sm outline-none ring-1 ring-gray-300 ring-inset placeholder:text-gray-400 focus:ring-2 focus:ring-emerald"},null,8,J),[[C,o[a.key]]])])),64))]),e("button",{class:"the-button mt-2",onClick:n}," \u4FEE\u6539 ")]),s[1]||(s[1]=e("div",{class:"col-span-0 lg:col-span-1"},null,-1))])]),_:1}))}};export{X as default};
